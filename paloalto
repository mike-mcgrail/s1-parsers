{
  attributes: {
    "dataSource.category": "security",
    "dataSource.name": "Palo Alto Networks Firewall",
    "dataSource.vendor": "Palo Alto Networks"
  }
  patterns: {
   //maps to high_resolution_timestamp:
   timestamp: "\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}.\\d{3}(\\+|-)\\d{2}:\\d{2}"
   //application_characteristic can be a single value, a comma delimited list in quotes, or blank. Null value is handled by format: traffic-2, not by this pattern.
   app_characteristic: "(\".*\")|[^,]+"
   //description field from system log is wrapped in quotes and may contain commas"
   desc: "(\".*\")"   
  }
  
  formats: [
    {
      format: ".*$timestamp=timestamp$(\\,)*",
    }, 
    {
      //match all fields. application_characteristic can be a single value, or a comma delimited list in quotes. 
      id: "traffic-1",
      attributes: { "event.type": "TRAFFIC", format: "traffic-1" },
      format: "\\d+,$network_activity.receive_time$,$firewall.serial_number$,TRAFFIC,$network_activity.sub_type$,\\d+,$network_activity.start_time_dt$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,,$app_name$,$firewall.virtual_system_id$,$client.is_trusted$,$isp.is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.start_time_dt$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$network_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$network_traffic.bytes$,$network_traffic.bytes_out$,$network_traffic.bytes_in$,$network_traffic.packets$,$network_activity.start_time_dt$,$network_activity.elapsed_time$,$network_activity.category_name$,$network_activity.test$,$device_hw_info.serial_number$,.*,$location.src_country$,$location.dst_country$,,$network_traffic.packets_out$,$network_traffic.packets_in$,$session.expiration_reason$,\\d+,\\d+,\\d+,\\d+,$firewall.virtual_system_name$,$device.name$,$network_activity.action_source$,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$network_connection_info.sctp_id$,$network_connection_info.sctp_chunks$,$network_connection_info.sctp_chunks_sent$,$network_connection_info.sctp_chunks_received$,$rule.uid$,$network_activity.http_connection$,$network_connection_info.app_flap_count$,$policy.uid$,$network_connection_info.link_switches$,$network_connection_info.sd_wan_cluster$,$network_connection_info.sd_wan_device_type$,$network_connection_info.sd_wan_cluster_type$,$network_connection_info.sd_wan_site$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os_edition$,$device.dst_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$policy.src_group$,$policy.dst_group$,$session.owner$,$network_activity.time$,.*,.*,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=app_characteristic$,$container.id$,$network_activity.app_tunnel_type$,$network_activity.is_saas$,$network_activity.is_sanctioned$,$network_activity.is_offloaded$",
      halt: true
    },
    {
      //dont match on application_characteristic for cases where is it blank.
      id: "traffic-2",
      attributes: { "event.type": "TRAFFIC", format: "traffic-2" },
      format: ".*,$network_activity.receive_time$,$firewall_serial_number$,TRAFFIC,$network_activity.subtype$,.*,$network_activity.start_time_dt$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$firewall.virtual_system_id$,$client.is_trusted$,$isp.is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.time$,$user.id$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.nat_src_port$,$network_endpoint.nat_dst_port$,$network_connection_info.tcp_flags$,$network_connection_info.protocol_name$,$network_activity.action$,$network_traffic.bytes$,$network_traffic.bytes_out$,$network_traffic.bytes_in$,$network_traffic.packets$,$network_activity.start_time_dt$,$network_activity.elapsed_time$,$network_activity.category_name$,$network_activity.test$,$device_hw_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$network_traffic.packets_out$,$network_traffic.packets_in$,$session.expiration_reason$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,$network_activity.action_source$,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$network_connection_info.sctp_id$,$network_connection_info.sctp_chunks$,$network_connection_info.sctp_chunks_sent$,$network_connection_info.sctp_chunks_received$,$rule.uid$,$network_activity.http_connection$,$network_connection_info.app_flap_count$,$policy.uid$,$network_connection_info.link_switches$,$network_connection_info.sd_wan_cluster$,$network_connection_info.sd_wan_device_type$,$network_connection_info.sd_wan_cluster_type$,$network_connection_info.sd_wan_site$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os_edition$,$device.dst_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hw_info.serial_number$,$policy.src_group$,$policy.dst_group$,$session.owner$,$network_activity.time$,.*,.*,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,.*,.*,$network_activity.app_tunnel_type$,$network_activity.is_saas$,$network_activity.is_sanctioned$,$network_activity.is_offloaded$",
      halt: true
    },
    {
      id: "system",
      attributes: { "event.type": "SYSTEM", format: "system" },
      format: ".*,$process_activity.receive_time$,$device_hw_info.serial_number$,SYSTEM,$process_activity.sub_type$,.*,$process_activity.start_time_dt$,$firewall.virtual_system_id$,$process_activity.activity_name$,$process_activity.observables$,.*,.*,$process_activity.enrichments$,$process_activity.severity$,$process_activity.message=desc$,$device_hw_info.serial_number$,.*,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,.*,$process_activity.time$",
      halt: true
    },
    {
      //matches THREAT logs with comma surround lists in application_characteristic and url_category_list. 
      id: "threat-1",
      attributes: { "event.type": "THREAT", format: "threat-1" },
      format: ".*,$threat.receive_time$,$device_hw_info.serial_number$,THREAT,$threat.subtype$,.*,$threat.created_time_dt$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_src_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$threat.app_name$,$firewall.virtual_system_id$,$client.is_trusted$,$isp.is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$threat.log_action$,.*,$session.uid$,$threat.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.nat_src_port$,$network_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$threat.action$,$url.text_file_name$,$threat.id$,$threat.category_name$,$threat.severity$,$network_traffic.direction$,$device_hw_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$event.category$,$threat.pcap_id$,$threat.file_digest$,.*,$url.index$,$http_request.user_agent$,$file.type$,$http_request.x_forwarded_for$,$http_request.referrer$,$email.smtp_from$,$email.subject$,$email.to$,$threat.report_id$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$http_request.http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$threat.category$,$threat.app_ver$,.*,$network_connection_info.sctp_id$,$network_connection_info.protocol_id$,$http_request.http_header$,\"$url.category_ids$\",$rule.uid$,$threat.http_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os_edition$,$device.dst_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hw_info.serial_number$,$domain.domain_edl$,$policy.src_group$,$policy.dst_group$,.*,$threat.time_dt$,.*,.*,.*,$threat.sub_category$,$threat.category_name$,$threat.app_model$,$threat.severity$,\"$threat.app_characteristic$\",$container.id$,$threat.app_tunnel_type$,$threat.is_saas$,$threat.is_sanctioned$",
      halt: true
    },
    {
      //matches THREAT logs without comma surround list in url_category_list. 
      id: "threat-2",
      attributes: { "event.type": "THREAT", format: "threat-2" },
      format: ".*,$threat.receive_time$,$device_hw_info.serial_number$,THREAT,$threat.sub_type$,.*,$threat.created_time_dt$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$app_name$,$firewall.virtual_system_id$,$client.is_trusted$,$isp.is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$threat.log_action$,.*,$session.uid$,$threat.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.nat_src_port$,$network_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$threat.action$,$url.text_file.name$,$threat.id$,$threat.category_name$,$threat.severity$,$network_traffic.direction$,$device_hw_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$event.category$,$threat.pcap_id$,$threat.file_digest$,.*,$url.index$,$http_request.user_agent$,$file.type$,$http_request.x_forwarded_for$,$http_request.referrer$,$email.smtp_from$,$email.subject$,$email.to$,$threat.report_id$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$http_request.http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$threat.category$,$threat.app_ver$,.*,$network_connection_info.sctp_id$,$network_connection_info.protocol_id$,$http_request.http_header$,$url.category_ids$,$rule.uid$,$threat.http_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os_edition$,$device.dst_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain.domain_edl$,$policy.src_group$,$policy.dst_group$,.*,$threat.time_dt$,.*,.*,.*,$threat.sub_category$,$threat.category_name$,$threat.app_model$,$threat.severity$,\"$threat.app_characteristic$\",$container.id$,$threat.app_tunnel_type$,$threat.is_saas$,$threat.is_sanctioned$",
      halt: true
    },
    {
      //matches THREAT logs without comma surround list in url_category_list or application_characteristic.
      id: "threat-3",
      attributes: { "event.type": "THREAT", format: "threat-3" },
      format: ".*,$threat.receive_time$,$device_hw_info.serial_number$,THREAT,$threat.subtype$,.*,$threat.created_time_dt$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$threat.app_name$,$firewall.virtual_system_id$,$client.is_trusted$,$isp.is_trusted$,$network_interface.inbound_name$,$network_interface.outbound_name$,$threat.log_action$,.*,$session.uid$,$threat.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$network_endpoint.nat_src_port$,$network_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$threat.action$,$url.text_file_name$,$threat.id$,$threat.category_name$,$threat.severity$,$network_traffic.direction$,$device_hw_info.serial_number$,.*,$location.src_country$,$location.dst_country$,.*,$event.category$,$threat.pcap_id$,$threat.file_digest$,.*,$url.index$,$http_request.user_agent$,$file.type$,$http_request.x_forwarded_for$,$http_request.referrer$,$email.smtp_from$,$email.subject$,$email.to$,$threat.report_id$,.*,.*,.*,.*,$firewall.virtual_system_name$,$device.name$,.*,$virtual_macine.src_vm_uuid$,$virtual_macine.dst_vm_uuid$,$http_request.http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$session.parent_created_time$,$network_connection_info.tunnel_type$,$threat.category$,$threat.app_ver$,.*,$network_connection_info.sctp_id$,$network_connection_info.protocol_id$,$http_request.http_header$,$url.category_ids$,$rule.uid$,$threat.http_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$network_connection_info.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.dst_os_edition$,$device.dst_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain.domain_edl$,$policy.src_group$,$policy.dst_group$,.*,$threat.time_dt$,.*,.*,.*,$threat.sub_category$,$threat.category_name$,$threat.app_model$,$threat.severity$,$threat.app_characteristic$,$container.id$,$threat.app_tunnel_type$,$threat.is_saas$,$threat.is_sanctioned$",
      halt: true
    }
  ]
}
